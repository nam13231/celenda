<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>M·ª•c Ti√™u H·ªçc T·∫≠p</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-image: url('mid.png');
      background-size: cover;
      background-position: center;
      color: #fff;
      text-align: center;
    }
    .container {
      background: rgba(0, 0, 0, 0.6);
      padding: 20px;
      max-width: 900px;
      margin: 40px auto;
      border-radius: 15px;
    }
    img {
      width: 100%;
      border-radius: 15px;
    }
    button {
      margin: 5px;
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      background-color: #4caf50;
      color: white;
    }
    #progress {
      margin-top: 20px;
      font-size: 18px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background: #ffffff10;
      overflow-x: auto;
    }
    th, td {
      border: 1px solid #ffffff30;
      padding: 8px;
      color: #fff;
    }
    input[type="time"], textarea {
      padding: 6px;
      border-radius: 6px;
      border: none;
    }
    #dailyQuote {
      font-size: 18px;
      margin-top: 20px;
      padding: 10px;
      background: #ffffff20;
      border-radius: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üéØ M·ª•c ti√™u h·ªçc t·∫≠p m·ªói ng√†y</h1>
    <img src="Xiaomi-Mi-11-Ultra.jpg" alt="Ph·∫ßn th∆∞·ªüng">
    <p id="progress">ƒêi·ªÉm hi·ªán t·∫°i: 0 / 3120 | C·∫•p ƒë·ªô: <span id="level">0</span></p>
    <div id="dailyQuote"></div>
    <div id="daily-buttons">
      <button onclick="diemDanh()">ƒêi·ªÉm danh h√¥m nay (+10)</button><br>
      <button onclick="congDiem('toan', 10)">H·ªçc To√°n (+10)</button>
      <button onclick="congDiem('ly', 10)">H·ªçc L√Ω (+10)</button>
      <button onclick="congDiem('hoa', 10)">H·ªçc H√≥a (+10)</button>
      <button onclick="congDiem('anh', 10)">H·ªçc Ti·∫øng Anh (+10)</button><br>
      <button onclick="congDiem('on', 30)">√în t·∫≠p ki·∫øn th·ª©c (+30)</button>
    </div>
    <div style="margin-top: 20px;">
      <label>‚è∞ ƒê·∫∑t gi·ªù nh·∫Øc h·ªçc: <input type="time" id="reminderTime"> <button onclick="setReminder()">L∆∞u</button></label>
    </div>
    <div style="margin-top: 15px;">
      <button style="background-color:#f44336" onclick="xoaLichHomNay()">üóëÔ∏è X√≥a d·ªØ li·ªáu h√¥m nay</button>
      <button style="background-color:#e91e63" onclick="xoaGhiChuHomNay()">üóíÔ∏è X√≥a ghi ch√∫ h√¥m nay</button>
    </div>
    <div style="margin-top: 30px;">
      <h2>üóìÔ∏è L·ªãch h·ªçc & Ghi ch√∫</h2>
      <table>
        <thead>
          <tr>
            <th>Ng√†y</th>
            <th>Nhi·ªám v·ª•</th>
            <th>Ghi ch√∫</th>
          </tr>
        </thead>
        <tbody id="calendarBody"></tbody>
      </table>
    </div>
    <canvas id="weeklyChart" width="400" height="200" style="margin-top:30px;"></canvas>
  </div>

  <script>
    const TOTAL_DAYS = 312;
    const TOTAL_SCORE = TOTAL_DAYS * 100;
    let diem = parseInt(localStorage.getItem("diem")) || 0;
    let today = new Date().toISOString().split('T')[0];
    let done = JSON.parse(localStorage.getItem("done")) || {};
    let notes = JSON.parse(localStorage.getItem("notes")) || {};
    let reminderTime = localStorage.getItem("reminderTime") || "";
    let lastCheck = localStorage.getItem("lastCheck") || "";

    const quotes = [
      "üìö H√¥m nay b·∫°n h·ªçc g√¨ r·ªìi? C·ªë g·∫Øng l√™n nh√©!",
      "üöÄ M·ªói ng√†y m·ªôt b∆∞·ªõc, b·∫°n s·∫Ω ti·∫øn xa!",
      "üí° H·ªçc h√¥m nay - Th√†nh c√¥ng ng√†y mai!",
      "üî• ƒê·ª´ng ƒë·ªÉ ng√†y h√¥m nay tr√¥i qua v√¥ √≠ch!",
      "üå± Tri th·ª©c l√† s·ª©c m·∫°nh, c·ªë l√™n b·∫°n nh√©!"
    ];

    function showDailyQuote() {
      const index = new Date().getDate() % quotes.length;
      document.getElementById("dailyQuote").innerText = quotes[index];
    }

    if (lastCheck && lastCheck !== today) {
      const missed = done[lastCheck];
      if (missed) {
        const tasks = ['on', 'toan', 'ly', 'hoa', 'anh', 'diemdanh'];
        tasks.forEach(task => {
          if (!missed[task]) diem -= task === 'on' ? 30 : 10;
        });
        diem = Math.max(0, diem);
        localStorage.setItem("diem", diem);
      }
    }
    localStorage.setItem("lastCheck", today);

    function getLevel(score) {
      if (score < 100) return 1;
      if (score < 250) return 2;
      if (score < 500) return 3;
      if (score < 1000) return 4;
      return 5;
    }

    function updateProgress() {
      document.getElementById("progress").innerText = `ƒêi·ªÉm hi·ªán t·∫°i: ${diem} / ${TOTAL_SCORE} | C·∫•p ƒë·ªô: ${getLevel(diem)}`;
    }

    function congDiem(task, amount) {
      let doneToday = done[today] || {};
      if (doneToday[task]) return alert("B·∫°n ƒë√£ ho√†n th√†nh nhi·ªám v·ª• n√†y h√¥m nay!");
      diem += amount;
      doneToday[task] = true;
      done[today] = doneToday;
      localStorage.setItem("diem", diem);
      localStorage.setItem("done", JSON.stringify(done));
      updateProgress();
      renderCalendar();
      renderWeeklyChart();
    }

    function diemDanh() {
      congDiem("diemdanh", 10);
    }

    function renderCalendar() {
      const tbody = document.getElementById("calendarBody");
      tbody.innerHTML = "";
      const days = Object.keys(done).sort().reverse();
      days.forEach(day => {
        const row = document.createElement("tr");
        const noteVal = notes[day] || "";
        row.innerHTML = `
          <td>${day}</td>
          <td>${Object.keys(done[day]).join(", ")}</td>
          <td><textarea onchange="saveNote('${day}', this.value)">${noteVal}</textarea></td>
        `;
        tbody.appendChild(row);
      });
    }

    function saveNote(day, value) {
      notes[day] = value;
      localStorage.setItem("notes", JSON.stringify(notes));
    }

    function renderWeeklyChart() {
      const ctx = document.getElementById('weeklyChart').getContext('2d');
      const labels = [];
      const data = [];
      const sortedDays = Object.keys(done).sort().slice(-7);
      sortedDays.forEach(day => {
        labels.push(day);
        const sum = Object.keys(done[day]).reduce((acc, task) => acc + (task === 'on' ? 30 : 10), 0);
        data.push(sum);
      });
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: 'ƒêi·ªÉm m·ªói ng√†y',
            data: data,
            backgroundColor: '#4caf50'
          }]
        },
        options: {
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });
    }

    showDailyQuote();
    updateProgress();
    renderCalendar();
    renderWeeklyChart();
  </script>
</body>
</html>
